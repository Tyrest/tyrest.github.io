<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Credit Card Finder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Warm Neutrals -->
    <!-- Application Structure Plan: The application is designed around a user-centric, task-oriented flow rather than mirroring the linear structure of the source report. It consists of three main sections: 1) An interactive "Find Your Match" recommender tool, which is the focal point, allowing users to get immediate, personalized recommendations based on their spending. 2) A "Compare All Cards" section for users who want to explore and compare the detailed features of each card side-by-side. 3) A "Master the Game" section that explains advanced multi-card strategies. This structure was chosen because it empowers the user to find answers quickly and then delve deeper as needed, making the information more accessible and actionable than a static report. -->
    <!-- Visualization & Content Choices: Report Info -> Goal -> Viz/Presentation -> Interaction -> Justification. 1) Spending habits & card value -> Personalize & Compare -> Sliders & Dynamic Bar Chart (Chart.js) -> User inputs spending, chart updates with calculated annual values -> Transforms static scenarios into a dynamic, personalized calculator for maximum user relevance. 2) Detailed card data -> Inform & Organize -> Grid of cards with Modals -> User clicks a card to see a detailed popup -> Prevents overwhelming the user with data, providing deep information on demand in a clean, focused manner. 3) Multi-card strategies -> Explain & Guide -> Styled content panels with icons -> Static visual presentation -> Breaks down complex strategies into easily digestible visual components for better comprehension. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f4;
            color: #4a4a4a;
        }

        .card-gradient {
            background: linear-gradient(135deg, #ffffff, #f1f1f1);
        }

        .btn-primary {
            background-color: #4a69bd;
            color: white;
            transition: background-color 0.3s ease;
        }

        .btn-primary:hover {
            background-color: #3b5699;
        }

        .nav-link {
            transition: color 0.3s ease, border-bottom-color 0.3s ease;
            border-bottom: 2px solid transparent;
        }

        .nav-link:hover,
        .nav-link.active {
            color: #4a69bd;
            border-bottom-color: #4a69bd;
        }

        .modal {
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-content {
            transition: transform 0.3s ease;
        }

        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }

        @media (min-width: 768px) {
            .chart-container {
                height: 400px;
            }
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #4a69bd;
            cursor: pointer;
            border-radius: 50%;
        }

        input[type=range]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #4a69bd;
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>

<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-40 shadow-sm">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-gray-800">
                Card<span class="text-4a69bd">Finder</span>
            </div>
            <div class="hidden md:flex space-x-8">
                <a href="#recommender" class="nav-link pb-1">Find Your Match</a>
                <a href="#card-library" class="nav-link pb-1">Compare All Cards</a>
                <a href="#strategies" class="nav-link pb-1">Master the Game</a>
            </div>
            <button id="mobile-menu-button" class="md:hidden p-2 rounded-md text-gray-600 hover:bg-gray-100">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                </svg>
            </button>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4">
            <a href="#recommender" class="block py-2 text-gray-700 hover:text-[#4a69bd]">Find Your Match</a>
            <a href="#card-library" class="block py-2 text-gray-700 hover:text-[#4a69bd]">Compare All Cards</a>
            <a href="#strategies" class="block py-2 text-gray-700 hover:text-[#4a69bd]">Master the Game</a>
        </div>
    </header>

    <main>
        <section id="hero" class="py-20 bg-white">
            <div class="container mx-auto px-6 text-center">
                <h1 class="text-4xl md:text-6xl font-bold text-gray-800 mb-4 leading-tight">Find the Perfect Credit
                    Card, Instantly.</h1>
                <p class="text-lg md:text-xl text-gray-600 max-w-3xl mx-auto mb-8">Stop guessing. Start maximizing. This
                    tool analyzes your spending to find the card that earns you the most rewards, turning your everyday
                    purchases into serious value.</p>
                <a href="#recommender" class="btn-primary font-bold py-3 px-8 rounded-full text-lg inline-block">Start
                    Analyzing My Spending</a>
            </div>
        </section>

        <section id="recommender" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-800">1. Find Your Match</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">Use the sliders to estimate your monthly
                        spending. Our engine will instantly calculate the potential annual rewards for each card and
                        recommend the best one for you.</p>
                </div>

                <div class="grid md:grid-cols-3 gap-8 mb-12">
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <label for="diningSpend" class="block text-lg font-semibold text-gray-700 mb-2">Dining &
                            Restaurants</label>
                        <input type="range" id="diningSpend" min="0" max="2000" step="50" value="500"
                            class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                        <div class="text-center text-2xl font-bold text-[#4a69bd] mt-2">$<span
                                id="diningSpendValue">500</span>/mo</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <label for="grocerySpend"
                            class="block text-lg font-semibold text-gray-700 mb-2">Groceries</label>
                        <input type="range" id="grocerySpend" min="0" max="2000" step="50" value="400"
                            class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                        <div class="text-center text-2xl font-bold text-[#4a69bd] mt-2">$<span
                                id="grocerySpendValue">400</span>/mo</div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <label for="otherSpend" class="block text-lg font-semibold text-gray-700 mb-2">All Other
                            Shopping</label>
                        <input type="range" id="otherSpend" min="0" max="5000" step="100" value="1000"
                            class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                        <div class="text-center text-2xl font-bold text-[#4a69bd] mt-2">$<span
                                id="otherSpendValue">1000</span>/mo</div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
                    <div class="grid md:grid-cols-3 gap-8">
                        <div class="md:col-span-1 text-center md:text-left">
                            <h3 class="text-2xl font-bold text-gray-800 mb-2">Your Top Match:</h3>
                            <div id="recommendation" class="bg-green-100 p-6 rounded-lg border-2 border-green-300">
                                <h4 id="topCardName" class="text-2xl font-bold text-green-800"></h4>
                                <p class="text-lg text-green-700 mt-2">Projected Net Value:</p>
                                <p id="topCardValue" class="text-4xl font-extrabold text-green-800"></p>
                                <p class="text-sm text-green-600 mt-2">after fees & credits</p>
                            </div>
                        </div>
                        <div class="md:col-span-2">
                            <h3 class="text-2xl font-bold text-gray-800 mb-4 text-center">Annual Value Comparison</h3>
                            <div class="chart-container">
                                <canvas id="rewardsChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="card-library" class="py-16 md:py-24 bg-white">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-800">2. Compare All Cards</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">Dive deeper into the details. Click on any
                        card to see a full breakdown of its rewards structure, fees, perks, and ideal user profile.</p>
                </div>
                <div id="cardGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8">
                </div>
            </div>
        </section>

        <section id="strategies" class="py-16 md:py-24">
            <div class="container mx-auto px-6">
                <div class="text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-800">3. Master the Game</h2>
                    <p class="mt-4 text-lg text-gray-600 max-w-3xl mx-auto">For those who want to maximize every dollar.
                        Explore advanced strategies that combine multiple cards to unlock exponential value from your
                        spending.</p>
                </div>
                <div class="grid md:grid-cols-1 lg:grid-cols-2 gap-12">
                    <div class="bg-white p-8 rounded-xl shadow-lg">
                        <h3 class="text-2xl font-bold text-[#4a69bd] mb-4">The "Chase Trifecta"</h3>
                        <p class="text-gray-600 mb-6">This is the gold standard for travel rewards. By combining three
                            specific Chase cards, you can pool points and transfer them to high-value airline and hotel
                            partners, dramatically increasing their worth.</p>
                        <div class="space-y-4">
                            <div class="flex items-center space-x-4">
                                <span
                                    class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 text-blue-800 font-bold text-lg">Engine</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Chase Sapphire Preferred®</h4>
                                    <p class="text-sm text-gray-600">Unlocks point transfers and boosts redemption
                                        value.</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-4">
                                <span
                                    class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 text-blue-800 font-bold text-lg">Workhorse</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Chase Freedom Unlimited®</h4>
                                    <p class="text-sm text-gray-600">High flat-rate earning on all non-bonus spending.
                                    </p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-4">
                                <span
                                    class="flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 text-blue-800 font-bold text-lg">Specialist</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Chase Freedom Flex℠</h4>
                                    <p class="text-sm text-gray-600">5% back in rotating categories for targeted
                                        high-value earning.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-8 rounded-xl shadow-lg">
                        <h3 class="text-2xl font-bold text-green-700 mb-4">The "Cash Back Duo"</h3>
                        <p class="text-gray-600 mb-6">A simple yet powerful no-fee strategy. Use one card dedicated to
                            your highest spending category for 5% back, and another for a high flat rate on everything
                            else.</p>
                        <div class="space-y-4">
                            <div class="flex items-center space-x-4">
                                <span
                                    class="flex items-center justify-center h-12 w-12 rounded-full bg-green-100 text-green-800 font-bold text-lg">Specialist</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Citi Custom Cash® Card</h4>
                                    <p class="text-sm text-gray-600">5% cash back in your top spend category (e.g.,
                                        dining).</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-4">
                                <span
                                    class="flex items-center justify-center h-12 w-12 rounded-full bg-green-100 text-green-800 font-bold text-lg">Workhorse</span>
                                <div>
                                    <h4 class="font-semibold text-gray-800">Wells Fargo Active Cash®</h4>
                                    <p class="text-sm text-gray-600">Unlimited 2% cash rewards on every other purchase.
                                    </p>
                                </div>
                            </div>
                        </div>
                        <p class="mt-8 text-sm text-gray-500 italic">This combination guarantees a minimum return of 2%
                            on all spending, with a 5% boost on your most frequent purchases, all for no annual fee.</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-white mt-16">
        <div class="container mx-auto px-6 py-8 text-center text-gray-400">
            <p>This is an interactive visualization based on the "Expert Analysis of Credit Cards" report. All data is
                for illustrative purposes.</p>
            <p class="text-sm mt-2">&copy; 2024 CardFinder. All Rights Reserved.</p>
        </div>
    </footer>

    <div id="cardModal"
        class="modal invisible opacity-0 fixed inset-0 w-full h-full z-50 flex items-center justify-center bg-black bg-opacity-60 p-4">
        <div id="modalContent"
            class="modal-content transform -translate-y-10 bg-white rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-white p-6 border-b border-gray-200 flex justify-between items-center">
                <h3 id="modalCardName" class="text-2xl font-bold text-gray-800"></h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-800">&times;</button>
            </div>
            <div id="modalBody" class="p-8">
            </div>
        </div>
    </div>


    <script>
        const cardData = [
            {
                id: 'amex_gold',
                name: 'American Express® Gold Card',
                annualFee: 325,
                ftf: false,
                credits: 240,
                pointValue: 0.018,
                rewards: {
                    dining: { rate: 4, cap: Infinity },
                    grocery: { rate: 4, cap: 25000 },
                    other: { rate: 1, cap: Infinity }
                },
                color: '#D4AF37',
                tagline: 'The premier foodie card.',
                details: {
                    description: "The undisputed market leader for consumers with high spending on food, both at restaurants and at home.",
                    idealUser: "A high-spending 'foodie' in an urban area who uses Uber/Grubhub and values luxury travel rewards.",
                    perks: [
                        "$120 annual Uber Cash credit ($10/mo)",
                        "$120 annual Dining credit ($10/mo)",
                        "No Foreign Transaction Fees",
                        "Excellent travel and purchase protections"
                    ]
                }
            },
            {
                id: 'chase_sapphire_preferred',
                name: 'Chase Sapphire Preferred®',
                annualFee: 95,
                ftf: false,
                credits: 50,
                pointValue: 0.018,
                rewards: {
                    dining: { rate: 3, cap: Infinity },
                    grocery: { rate: 3, cap: Infinity, type: 'online' },
                    other: { rate: 1, cap: Infinity }
                },
                color: '#1c61ac',
                tagline: 'Best all-around travel starter.',
                details: {
                    description: "Widely regarded as the best entry point into travel rewards, balancing strong rewards with a modest fee.",
                    idealUser: "Someone ready to move beyond cash back who dines out, orders groceries online, and travels occasionally.",
                    perks: [
                        "$50 annual hotel credit via Chase Portal",
                        "Points worth 25% more for travel via Chase Portal",
                        "1:1 point transfer to airline & hotel partners",
                        "Primary auto rental insurance"
                    ]
                }
            },
            {
                id: 'us_bank_altitude_go',
                name: 'U.S. Bank Altitude® Go',
                annualFee: 0,
                ftf: false,
                credits: 15,
                pointValue: 0.01,
                rewards: {
                    dining: { rate: 4, cap: 8000 },
                    grocery: { rate: 2, cap: Infinity },
                    other: { rate: 1, cap: Infinity }
                },
                color: '#003366',
                tagline: 'No-fee dining powerhouse.',
                details: {
                    description: "Offers one of the highest cash back rates on dining for a no-annual-fee card, but with a spending cap.",
                    idealUser: "A budget-conscious foodie who spends less than $667/month on dining and wants simple, high rewards.",
                    perks: [
                        "$15 annual streaming credit",
                        "4X points on dining is a high rate for a no-fee card",
                        "No Foreign Transaction Fees"
                    ]
                }
            },
            {
                id: 'citi_custom_cash',
                name: 'Citi Custom Cash® Card',
                annualFee: 0,
                ftf: true,
                credits: 0,
                pointValue: 0.01,
                rewards: {
                    dining: { rate: 5, cap: 6000, type: 'top_category' },
                    grocery: { rate: 5, cap: 6000, type: 'top_category' },
                    other: { rate: 1, cap: Infinity }
                },
                color: '#007ac1',
                tagline: '5% in your top category.',
                details: {
                    description: "A unique card that automatically gives 5% back in your top eligible spend category each billing cycle.",
                    idealUser: "A strategic spender who can dedicate this card to a single category (like dining) to consistently hit the 5% rate.",
                    perks: [
                        "Automatic 5% earning, no activation needed",
                        "5% cap applies to first $500 spend per billing cycle",
                        "Can be converted to ThankYou points with a premium Citi card"
                    ]
                }
            },
            {
                id: 'capone_savorone',
                name: 'Capital One SavorOne Rewards',
                annualFee: 0,
                ftf: false,
                credits: 0,
                pointValue: 0.01,
                rewards: {
                    dining: { rate: 3, cap: Infinity },
                    grocery: { rate: 3, cap: Infinity },
                    other: { rate: 1, cap: Infinity }
                },
                color: '#a00f1c',
                tagline: 'Best single no-fee card.',
                details: {
                    description: "A premier no-fee option with unlimited 3% cash back across a wide range of practical, everyday categories.",
                    idealUser: "The consumer seeking the best 'one-card wallet' who values simplicity and has broad spending across food and entertainment.",
                    perks: [
                        "Unlimited 3% cash back on dining, groceries, and entertainment",
                        "No Foreign Transaction Fees (rare for a no-fee card)",
                        "Access to Capital One Dining & Entertainment portals"
                    ]
                }
            },
            {
                id: 'chase_freedom_unlimited',
                name: 'Chase Freedom Unlimited®',
                annualFee: 0,
                ftf: true,
                credits: 0,
                pointValue: 0.01,
                rewards: {
                    dining: { rate: 3, cap: Infinity },
                    grocery: { rate: 1.5, cap: Infinity },
                    other: { rate: 1.5, cap: Infinity }
                },
                color: '#005587',
                tagline: 'The workhorse catch-all.',
                details: {
                    description: "A stellar 'catch-all' card that becomes a powerhouse when paired with a Sapphire card in the Chase ecosystem.",
                    idealUser: "A rewards maximizer who pairs it with a Sapphire card to optimize every single purchase with a high 1.5% base rate.",
                    perks: [
                        "1.5% base earning rate is excellent for a no-fee card",
                        "3% on dining and drugstores",
                        "Points can be converted to full Ultimate Rewards points with a Sapphire card"
                    ]
                }
            },
            {
                id: 'bofa_customized_cash',
                name: 'BofA® Customized Cash',
                annualFee: 0,
                ftf: true,
                credits: 0,
                pointValue: 0.01,
                rewards: {
                    dining: { rate: 3, cap: 10000, type: 'choice' },
                    grocery: { rate: 2, cap: 10000 },
                    other: { rate: 1, cap: Infinity },
                    online: { rate: 3, cap: 10000, type: 'choice' }
                },
                color: '#E01E27',
                tagline: 'Flexible 3% choice.',
                details: {
                    description: "A flexible card that lets you choose your 3% cash back category, with a huge potential boost for BofA clients.",
                    idealUser: "Existing Bank of America customers who can leverage the Preferred Rewards bonus, or anyone with a high spend in one of the choice categories (like online shopping).",
                    perks: [
                        "Choose your 3% category (gas, online shopping, dining, etc.)",
                        "2% back at grocery stores and wholesale clubs",
                        "Rewards boosted 25%-75% for Preferred Rewards members"
                    ]
                }
            }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            const diningSlider = document.getElementById('diningSpend');
            const grocerySlider = document.getElementById('grocerySpend');
            const otherSlider = document.getElementById('otherSpend');
            const diningValue = document.getElementById('diningSpendValue');
            const groceryValue = document.getElementById('grocerySpendValue');
            const otherValue = document.getElementById('otherSpendValue');
            const topCardName = document.getElementById('topCardName');
            const topCardValue = document.getElementById('topCardValue');
            const cardGrid = document.getElementById('cardGrid');
            const modal = document.getElementById('cardModal');
            const modalContent = document.getElementById('modalContent');
            const closeModalBtn = document.getElementById('closeModal');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            const ctx = document.getElementById('rewardsChart').getContext('2d');
            let rewardsChart;

            const createChart = () => {
                rewardsChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: cardData.map(c => c.name.split('®')[0]),
                        datasets: [{
                            label: 'Projected Net Annual Value ($)',
                            data: [],
                            backgroundColor: cardData.map(c => c.color),
                            borderColor: cardData.map(c => c.color),
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        plugins: {
                            legend: {
                                display: false
                            },
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        return `Net Value: $${context.raw.toFixed(2)}`;
                                    }
                                }
                            }
                        },
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Net Annual Value ($)'
                                }
                            },
                            y: {
                                ticks: {
                                    autoSkip: false,
                                    callback: function (value, index, values) {
                                        const label = this.getLabelForValue(value);
                                        if (label.length > 20) {
                                            return label.substring(0, 20) + '...';
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            const calculateAnnualValue = (card, spends) => {
                let diningSpend = spends.dining * 12;
                let grocerySpend = spends.grocery * 12;
                let otherSpend = spends.other * 12;
                let totalRewards = 0;

                let diningRewards = 0;
                let groceryRewards = 0;
                let otherRewards = otherSpend * card.rewards.other.rate;

                if (card.id === 'citi_custom_cash') {
                    const categories = { dining: diningSpend, grocery: grocerySpend };
                    const topCat = Object.keys(categories).reduce((a, b) => categories[a] > categories[b] ? a : b);

                    if (topCat === 'dining') {
                        diningRewards = Math.min(diningSpend, card.rewards.dining.cap) * card.rewards.dining.rate + Math.max(0, diningSpend - card.rewards.dining.cap) * card.rewards.other.rate;
                        groceryRewards = grocerySpend * card.rewards.other.rate;
                    } else {
                        groceryRewards = Math.min(grocerySpend, card.rewards.grocery.cap) * card.rewards.grocery.rate + Math.max(0, grocerySpend - card.rewards.grocery.cap) * card.rewards.other.rate;
                        diningRewards = diningSpend * card.rewards.other.rate;
                    }
                } else if (card.id === 'bofa_customized_cash') {
                    const onlineSpendIsHigher = otherSpend > diningSpend;
                    if (onlineSpendIsHigher) {
                        otherRewards = Math.min(otherSpend, card.rewards.online.cap) * card.rewards.online.rate + Math.max(0, otherSpend - card.rewards.online.cap) * card.rewards.other.rate;
                        diningRewards = diningSpend * card.rewards.other.rate;
                        groceryRewards = Math.min(grocerySpend, card.rewards.grocery.cap - otherSpend) * card.rewards.grocery.rate + Math.max(0, grocerySpend - (card.rewards.grocery.cap - otherSpend)) * card.rewards.other.rate;
                    } else {
                        diningRewards = Math.min(diningSpend, card.rewards.dining.cap) * card.rewards.dining.rate + Math.max(0, diningSpend - card.rewards.dining.cap) * card.rewards.other.rate;
                        otherRewards = otherSpend * card.rewards.other.rate;
                        groceryRewards = Math.min(grocerySpend, card.rewards.grocery.cap - diningSpend) * card.rewards.grocery.rate + Math.max(0, grocerySpend - (card.rewards.grocery.cap - diningSpend)) * card.rewards.other.rate;
                    }
                }
                else {
                    diningRewards = Math.min(diningSpend, card.rewards.dining.cap) * card.rewards.dining.rate;
                    groceryRewards = card.rewards.grocery.type === 'online'
                        ? grocerySpend * card.rewards.grocery.rate
                        : Math.min(grocerySpend, card.rewards.grocery.cap) * card.rewards.grocery.rate;
                }

                totalRewards = diningRewards + groceryRewards + otherRewards;

                const grossValue = totalRewards * card.pointValue;
                const netFee = card.annualFee - card.credits;

                return grossValue - netFee;
            };

            const updateRecommendations = () => {
                const spends = {
                    dining: parseInt(diningSlider.value),
                    grocery: parseInt(grocerySlider.value),
                    other: parseInt(otherSlider.value),
                };

                const cardValues = cardData.map(card => ({
                    ...card,
                    annualValue: calculateAnnualValue(card, spends)
                }));

                cardValues.sort((a, b) => b.annualValue - a.annualValue);

                const bestCard = cardValues[0];
                topCardName.textContent = bestCard.name;
                topCardValue.textContent = `$${Math.round(bestCard.annualValue)}`;

                rewardsChart.data.datasets[0].data = cardValues.map(c => c.annualValue);
                rewardsChart.update();
            };

            const populateCardGrid = () => {
                cardData.forEach(card => {
                    const cardElement = document.createElement('div');
                    cardElement.className = 'card-gradient p-6 rounded-xl shadow-lg cursor-pointer transform hover:scale-105 transition-transform duration-300';
                    cardElement.innerHTML = `
                <div class="h-full flex flex-col justify-between">
                    <div>
                        <h3 class="text-xl font-bold text-gray-800">${card.name}</h3>
                        <p class="text-gray-600 mt-2">${card.tagline}</p>
                    </div>
                    <div class="mt-4 text-right font-semibold text-[${card.color}]">View Details &rarr;</div>
                </div>
            `;
                    cardElement.addEventListener('click', () => openModal(card));
                    cardGrid.appendChild(cardElement);
                });
            };

            const openModal = (card) => {
                document.getElementById('modalCardName').textContent = card.name;
                const modalBody = document.getElementById('modalBody');

                const perksList = card.details.perks.map(perk => `<li class="flex items-start"><span class="text-green-500 mr-3 mt-1">&#10003;</span><span>${perk}</span></li>`).join('');

                modalBody.innerHTML = `
            <div class="grid md:grid-cols-2 gap-6 text-gray-700">
                <div>
                    <h4 class="font-bold text-lg mb-2 text-gray-800">Core Proposition</h4>
                    <p>${card.details.description}</p>
                </div>
                <div>
                    <h4 class="font-bold text-lg mb-2 text-gray-800">Ideal User</h4>
                    <p>${card.details.idealUser}</p>
                </div>
            </div>
            <div class="mt-6">
                <h4 class="font-bold text-lg mb-2 text-gray-800">Key Perks & Credits</h4>
                <ul class="space-y-2">${perksList}</ul>
            </div>
            <div class="mt-6 bg-gray-100 p-4 rounded-lg">
                <h4 class="font-bold text-lg mb-2 text-gray-800">Fees</h4>
                <div class="flex justify-between">
                    <span>Annual Fee:</span>
                    <span class="font-semibold">$${card.annualFee}</span>
                </div>
                <div class="flex justify-between">
                    <span>Foreign Transaction Fee:</span>
                    <span class="font-semibold">${card.ftf ? '3%' : 'None'}</span>
                </div>
            </div>
        `;
                modal.classList.remove('invisible', 'opacity-0');
                modalContent.classList.remove('-translate-y-10');
            };

            const closeModal = () => {
                modal.classList.add('invisible', 'opacity-0');
                modalContent.classList.add('-translate-y-10');
            };

            [diningSlider, grocerySlider, otherSlider].forEach(slider => {
                slider.addEventListener('input', () => {
                    diningValue.textContent = diningSlider.value;
                    groceryValue.textContent = grocerySlider.value;
                    otherValue.textContent = otherSlider.value;
                    updateRecommendations();
                });
            });

            closeModalBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeModal();
                }
            });

            createChart();
            updateRecommendations();
            populateCardGrid();
        });
    </script>

</body>

</html>